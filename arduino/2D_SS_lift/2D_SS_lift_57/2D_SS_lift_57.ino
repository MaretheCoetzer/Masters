// HOW TO:
// ------------------------------
// Serial input = 2 -> Steps through gait sequence once and stops at the end.
// Serial input = 1 -> Steps through gait sequence in a loop.
// Serial input = 0 -> Stops infinite loop at the node where it is at that moment

//Gait template
#include <Wire.h>
#include <Adafruit_PWMServoDriver.h>

Adafruit_PWMServoDriver pca9685 = Adafruit_PWMServoDriver();

#define SERVO_FREQ 300
#define SER0 0 //Hip 1
#define SER1 1 //Knee 1
#define SER2 2 //Hip 2
#define SER3 3 //Knee 2
#define SER4 4 //Hip 3
#define SER5 5 //Knee 3
#define SER6 6 //Hip 4
#define SER7 7 //Knee 4

// Insert servo angles here:
// For 3D gaits, these angles are obtained from linearisation.py
// For 2D gaits, these angles are obtained from 2D_trajectory_reader.py
float SS_servo0[] = {-2.92496122e-01, -2.67370765e-01, -2.44000588e-01, -2.22364343e-01, -2.14529329e-01, -2.14431125e-01, -2.14332921e-01, -2.14234717e-01, -2.14136513e-01, -2.14038308e-01, -2.13940104e-01, -2.25276940e-01, -2.40425983e-01, -2.55575025e-01, -2.70724067e-01, -2.85873109e-01, -3.00070330e-01, -3.05602250e-01, -3.00723882e-01, -2.84541633e-01, -2.58076420e-01, -2.25980709e-01, -1.93206988e-01, -1.57362912e-01, -1.20623250e-01, -8.37201268e-02, -4.75615693e-02, -1.71504315e-02, -4.66620885e-03, -1.72093892e-04,  2.27651159e-03,  4.72511707e-03,  5.61090003e-03,  4.50806852e-03,  3.40523702e-03,  2.30240552e-03,  1.19957402e-03,  9.67425124e-05, -1.00608899e-03, -2.10892049e-03, -3.21175200e-03, -4.31458350e-03, -1.06703671e-02, -1.71781081e-02, -2.36858490e-02, -3.01935900e-02, -3.67013309e-02, -4.32090719e-02, -5.00955232e-02, -5.79358816e-02, -6.24754061e-02, -6.38005643e-02, -6.33482664e-02, -6.60683653e-02, -7.15016076e-02, -7.69348499e-02, -8.23680922e-02, -9.50261306e-02, -1.08354010e-01, -1.23208194e-01, -1.41099799e-01, -1.58274690e-01, -1.67546942e-01, -1.75240474e-01, -1.77381970e-01, -1.71640336e-01, -1.68046474e-01, -1.67744490e-01, -1.68916238e-01, -1.70313500e-01, -1.73633412e-01, -1.76953324e-01, -1.83445349e-01, -1.90103763e-01, -1.93326073e-01, -1.99245479e-01, -2.05018398e-01, -2.07698856e-01, -2.08581949e-01, -2.12427035e-01, -2.16030361e-01, -2.16489937e-01, -2.16949514e-01, -2.17409091e-01, -2.17868668e-01, -2.18328245e-01, -2.18787822e-01, -2.19247399e-01, -2.28157139e-01, -2.37164006e-01, -2.46170872e-01, -2.55177739e-01, -2.64184605e-01, -2.77818826e-01, -2.81873652e-01, -2.77258527e-01, -2.68953896e-01, -2.59175717e-01, -2.56104387e-01, -2.54017233e-01, -2.51949657e-01, -2.49882082e-01, -2.49186185e-01, -2.50349532e-01, -2.51512878e-01, -2.59126090e-01, -2.68929406e-01, -2.80200693e-01, -2.87771801e-01, -2.97541658e-01};
float SS_servo1[] = {0.19867022, 0.1325425 , 0.09783546, 0.0745727 , 0.09243805, 0.13335934, 0.17428063, 0.21520192, 0.25612321, 0.2970445 , 0.33796579, 0.40822928, 0.48827484, 0.5683204 , 0.64836596, 0.72841152, 0.80132885, 0.84252972, 0.8437373 , 0.80372331, 0.72548908, 0.63466296, 0.54353069, 0.45735722, 0.37395652, 0.29179351, 0.21084467, 0.14384808, 0.11274193, 0.09601311, 0.08625201, 0.07649091, 0.06999157, 0.06764267, 0.06529377, 0.06294487, 0.06059596, 0.05824706, 0.05589816, 0.05354926, 0.05120036, 0.04885146, 0.05595642, 0.06333487, 0.07071332, 0.07809176, 0.08547021, 0.09284866, 0.10052675, 0.10791286, 0.10991637, 0.1034048 , 0.09383771, 0.08742891, 0.08572078, 0.08401264, 0.08230451, 0.08686906, 0.09201517, 0.09798847, 0.10528192, 0.11273083, 0.12362118, 0.13213384, 0.13160394, 0.11160112, 0.09551176, 0.08764039, 0.08276991, 0.07942831, 0.07922804, 0.07902776, 0.0841042 , 0.08965942, 0.09212462, 0.09771211, 0.10285974, 0.10058862, 0.09471814, 0.09770681, 0.10023263, 0.0967398 , 0.09324696, 0.08975412, 0.08626128, 0.08276844, 0.07927561, 0.07578277, 0.09052811, 0.10548309, 0.12043806, 0.13539303, 0.15034801, 0.17411991, 0.1770005 , 0.16315838, 0.14358873, 0.12333866, 0.11392505, 0.10950582, 0.10595477, 0.10240373, 0.10174012, 0.10499029, 0.10824046, 0.12464516, 0.14562671, 0.16771651, 0.18713562, 0.21266708};
float SS_servo2[] = { 0.16061192,  0.16440004,  0.15797921,  0.14926273,  0.14196586,  0.13546481,  0.12896376,  0.1224627 ,  0.11596165,  0.1094606 ,  0.10295955,  0.09207118,  0.07972016,  0.06736914,  0.05501812,  0.0426671 ,  0.03102009,  0.02642125,  0.02291752,  0.01996005,  0.0191341 ,  0.0164038 ,  0.01276601,  0.0069843 ,  0.00165144, -0.00785417, -0.02221324, -0.03119538, -0.03278223, -0.03290895, -0.03456537, -0.0362218 , -0.03720188, -0.03732134, -0.03744081, -0.03756027, -0.03767974, -0.0377992 , -0.03791867, -0.03803813, -0.0381576 , -0.03827707, -0.04122834, -0.04426153, -0.04729473, -0.05032792, -0.05336111, -0.0563943 , -0.0595479 , -0.06348136, -0.06711472, -0.07113768, -0.07582197, -0.0817763 , -0.08842495, -0.09507359, -0.10172224, -0.11108372, -0.12069673, -0.13066685, -0.14027781, -0.14914884, -0.15651995, -0.1659287 , -0.18055083, -0.21278312, -0.24983139, -0.2853896 , -0.31944975, -0.35339412, -0.38371609, -0.41403806, -0.43809481, -0.46007103, -0.47426452, -0.47874209, -0.47444986, -0.46214948, -0.43757454, -0.40483014, -0.37120714, -0.32615938, -0.28111162, -0.23606385, -0.19101609, -0.14596832, -0.10092056, -0.0558728 , -0.01548246,  0.02485433,  0.06519113,  0.10552793,  0.14586473,  0.17065291,  0.17340606,  0.17145351,  0.16989498,  0.16895277,  0.17050439,  0.17131101,  0.17181425,  0.17231749,  0.17212352,  0.1709845 ,  0.16984549,  0.16938489,  0.17055974,  0.17178035,  0.16980804,  0.16103093};       
float SS_servo3[] = {0.13619751, 0.11189721, 0.09961317, 0.09201987, 0.08524043, 0.07891723, 0.07259403, 0.06627084, 0.05994764, 0.05362444, 0.04730125, 0.05417591, 0.06545046, 0.07672502, 0.08799957, 0.09927412, 0.11109024, 0.11022579, 0.10665729, 0.10319832, 0.09672808, 0.0937723 , 0.09249288, 0.09737956, 0.10296303, 0.11586042, 0.13805579, 0.15138459, 0.14889148, 0.14154763, 0.14009214, 0.13863664, 0.13592237, 0.13160637, 0.12729038, 0.12297438, 0.11865838, 0.11434238, 0.11002638, 0.10571039, 0.10139439, 0.09707839, 0.09730525, 0.09766353, 0.09802181, 0.09838008, 0.09873836, 0.09909664, 0.09922999, 0.09874215, 0.0989406 , 0.09792068, 0.09875954, 0.09892554, 0.09974947, 0.10057341, 0.10139734, 0.09934302, 0.09702185, 0.09315271, 0.08376759, 0.07447985, 0.08153917, 0.09351828, 0.11813142, 0.18020254, 0.26251074, 0.34748349, 0.43345279, 0.52851722, 0.62182612, 0.71513503, 0.80107274, 0.88417894, 0.95408174, 0.99375419, 1.00851033, 0.99850386, 0.95474764, 0.89644365, 0.83700914, 0.76287394, 0.68873874, 0.61460354, 0.54046834, 0.46633314, 0.39219794, 0.31806274, 0.28103506, 0.24443388, 0.20783271, 0.17123154, 0.13463037, 0.11835831, 0.10901788, 0.10824541, 0.10834831, 0.10955577, 0.1030364 , 0.10115899, 0.10075763, 0.10035626, 0.1015281 , 0.10483235, 0.1081366 , 0.11029091, 0.10934064, 0.10648082, 0.11497938, 0.1394261 };
float SS_servo4[] = { 2.40000571e-01,  2.25604020e-01,  2.05471492e-01,  1.85303420e-01,  1.71235584e-01,  1.60587468e-01,  1.49939353e-01,  1.39291237e-01,  1.28643122e-01,  1.17995006e-01,  1.07346891e-01,  1.02960202e-01,  1.00660943e-01,  9.83616851e-02,  9.60624268e-02,  9.37631684e-02,  9.16567622e-02,  8.58497419e-02,  7.87787011e-02,  7.48145332e-02,  6.81671476e-02,  6.33134789e-02,  5.92971018e-02,  6.11198544e-02,  6.51630149e-02,  6.90056431e-02,  7.00399166e-02,  6.70740107e-02,  5.49298117e-02,  4.04726651e-02,  3.64544130e-02,  3.24361608e-02,  2.82476184e-02,  2.38423898e-02,  1.94371613e-02,  1.50319328e-02,  1.06267043e-02,  6.22147574e-03,  1.81624721e-03, -2.58898131e-03, -6.99420984e-03, -1.13994384e-02, -1.07001693e-02, -9.85323737e-03, -9.00630545e-03, -8.15937354e-03, -7.31244162e-03, -6.46550970e-03, -5.88926389e-03, -7.03077861e-03, -9.38522792e-03, -1.44214386e-02, -1.60092536e-02, -1.71035508e-02, -1.13606595e-02, -5.61776824e-03,  1.25123051e-04,  2.03952475e-02,  4.20122522e-02,  6.74219918e-02,  9.47612702e-02,  1.08152894e-01,  1.05034595e-01,  8.88774383e-02,  7.16553112e-02,  5.89824060e-02,  4.48513858e-02,  3.00603471e-02,  1.41371183e-02, -2.17888507e-03, -1.79123484e-02, -3.36458117e-02, -5.09026761e-02, -6.87699576e-02, -8.74437564e-02, -1.09111460e-01, -1.32042342e-01, -1.53795955e-01, -1.66656787e-01, -1.72544821e-01, -1.76952207e-01, -1.62105806e-01, -1.47259406e-01, -1.32413005e-01, -1.17566605e-01, -1.02720204e-01, -8.78738034e-02, -7.30274028e-02, -4.60911367e-02, -1.90159097e-02,  8.05931726e-03,  3.51345442e-02,  6.22097712e-02,  8.91920010e-02,  1.16147390e-01,  1.43576519e-01,  1.69917337e-01,  1.93179310e-01,  2.13533620e-01,  2.26284599e-01,  2.37048758e-01,  2.47812917e-01,  2.54664105e-01,  2.56211454e-01,  2.57758803e-01,  2.50139894e-01,  2.36766133e-01,  2.23917260e-01,  2.28514333e-01,  2.42579184e-01};
float SS_servo5[] = {-0.11820081, -0.10532283, -0.08958339, -0.07378441, -0.06667611, -0.06443972, -0.06220332, -0.05996692, -0.05773052, -0.05549412, -0.05325772, -0.05949836, -0.06856508, -0.07763179, -0.08669851, -0.09576522, -0.10324567, -0.10158883, -0.09787808, -0.09923751, -0.09385684, -0.0924762 , -0.09295693, -0.10347172, -0.116875  , -0.13102596, -0.14007353, -0.13898066, -0.12001478, -0.09823032, -0.09480038, -0.09137044, -0.08754575, -0.08321874, -0.07889173, -0.07456472, -0.07023771, -0.0659107 , -0.0615837 , -0.05725669, -0.05292968, -0.04860267, -0.05586111, -0.0634547 , -0.07104829, -0.07864188, -0.08623546, -0.09382905, -0.10133374, -0.1075162 , -0.10994784, -0.10893827, -0.11445152, -0.12426511, -0.14876539, -0.17326567, -0.19776594, -0.2610894 , -0.32801232, -0.40531207, -0.49248902, -0.54945736, -0.55134639, -0.52496854, -0.49419375, -0.47668205, -0.45653477, -0.43333373, -0.40772398, -0.380197  , -0.3546241 , -0.32905119, -0.30151946, -0.27259149, -0.23809277, -0.19984754, -0.15925922, -0.12246856, -0.10579292, -0.10441067, -0.1061537 , -0.14853675, -0.19091981, -0.23330286, -0.27568591, -0.31806896, -0.36045202, -0.40283507, -0.45510146, -0.50748146, -0.55986146, -0.61224145, -0.66462145, -0.70730776, -0.7443393 , -0.7753872 , -0.79365547, -0.79105392, -0.78207758, -0.73644096, -0.68106197, -0.62568299, -0.55943677, -0.47846054, -0.39748431, -0.29839215, -0.177794  , -0.09240143, -0.09730329, -0.11938679};       
float SS_servo6[] = {0.26367028, 0.24707887, 0.23068882, 0.21544662, 0.20069733, 0.18622438, 0.17175142, 0.15727847, 0.14280551, 0.12833256, 0.1138596 , 0.10410761, 0.09592949, 0.08775137, 0.07957326, 0.07139514, 0.06554372, 0.06119046, 0.05612791, 0.04987516, 0.04758012, 0.04474244, 0.04161808, 0.03751559, 0.03316401, 0.02887893, 0.02784238, 0.03257191, 0.05494223, 0.09111169, 0.13289201, 0.17467234, 0.20949023, 0.23544876, 0.26140728, 0.28736581, 0.31332434, 0.33928287, 0.3652414 , 0.39119992, 0.41715845, 0.44311698, 0.44870516, 0.45370406, 0.45870296, 0.46370186, 0.46870076, 0.47369966, 0.47793426, 0.47618562, 0.47546982, 0.47608677, 0.47389903, 0.46703605, 0.45495894, 0.44288184, 0.43080473, 0.40900229, 0.38629818, 0.36220128, 0.33367423, 0.30907926, 0.30607179, 0.30307054, 0.29998473, 0.29529767, 0.28992014, 0.28597525, 0.281281  , 0.27661706, 0.27216494, 0.26771281, 0.26429482, 0.26103068, 0.25902347, 0.25777831, 0.25696042, 0.25112806, 0.24084468, 0.23523155, 0.22972462, 0.22559878, 0.22147293, 0.21734709, 0.21322124, 0.2090954 , 0.20496955, 0.20084371, 0.20205469, 0.20332701, 0.20459934, 0.20587166, 0.20714398, 0.20644381, 0.20385406, 0.20161909, 0.20033074, 0.1991663 , 0.19198239, 0.18994834, 0.18931214, 0.18867594, 0.19012262, 0.19439255, 0.19866249, 0.21073846, 0.22610605, 0.2430832 , 0.25644217, 0.26784078};
float SS_servo7[] = {-0.21337321, -0.19618979, -0.18800864, -0.18213286, -0.17367185, -0.16376159, -0.15385134, -0.14394108, -0.13403083, -0.12412057, -0.11421032, -0.10966732, -0.10691366, -0.10416   , -0.10140634, -0.09865268, -0.09860655, -0.09993237, -0.10029769, -0.09705221, -0.10048878, -0.10322704, -0.10557111, -0.10413916, -0.10058182, -0.09830139, -0.10319486, -0.11776137, -0.16912341, -0.25058141, -0.34098143, -0.43138146, -0.48461727, -0.49056345, -0.49650962, -0.5024558 , -0.50840198, -0.51434816, -0.52029434, -0.52624052, -0.5321867 , -0.53813287, -0.48661594, -0.43343672, -0.38025749, -0.32707827, -0.27389904, -0.22071982, -0.16772595, -0.12616969, -0.10181857, -0.10003979, -0.10400504, -0.11000794, -0.1166325 , -0.12325706, -0.12988162, -0.13424998, -0.13840915, -0.14461476, -0.13745823, -0.11953513, -0.12158314, -0.12279575, -0.1216444 , -0.12089952, -0.11918463, -0.11871239, -0.11669347, -0.11364853, -0.1117055 , -0.10976248, -0.11099935, -0.11239605, -0.11242838, -0.11629707, -0.12114793, -0.1171336 , -0.1041402 , -0.09749271, -0.09104436, -0.08718557, -0.08332677, -0.07946798, -0.07560919, -0.07175039, -0.0678916 , -0.06403281, -0.06954077, -0.0751564 , -0.08077203, -0.08638766, -0.09200328, -0.09398103, -0.09397213, -0.09414   , -0.09456401, -0.0928985 , -0.08161557, -0.07775938, -0.07591312, -0.07406687, -0.07628261, -0.08400418, -0.09172574, -0.11484632, -0.14432882, -0.17873119, -0.20109157, -0.21772169}; 

int node=0;
int first=0;
int input=0;
int end_time=0;
int time_step=120000;
int steps = sizeof(SS_servo0)/sizeof(SS_servo0[0]);
int one_print = 0;

// -------------------Joint configurations-------------------
int servo0=0;
int servo0_deg=0;
int servo1=0;
int servo1_deg=0;
int servo2=0;
int servo2_deg=0;
int servo3=0;
int servo3_deg=0;
int servo4=0;
int servo4_deg=0;
int servo5=0;
int servo5_deg=0;
int servo6=0;
int servo6_deg=0;
int servo7=0;
int servo7_deg=0;

void setup() {
  Serial.begin(115200);
  pca9685.begin();

  pca9685.setOscillatorFrequency(27000000); //Value between 24MHz and 27MHz, tuned for this setup
  pca9685.setPWMFreq(SERVO_FREQ);
  delay (1000);

  servo0_deg=SS_servo0[0]/3.14159265*180;
  servo0=map(servo0_deg,-38,90,2200,1030);
  servo1_deg=SS_servo1[0]/3.14159265*180;
  servo1=map(servo1_deg,-90,90,2600,950);
  servo2_deg=SS_servo2[0]/3.14159265*180;
  servo2=map(servo2_deg,-38,90,1510,2730);
  servo3_deg=SS_servo3[0]/3.14159265*180;
  servo3=map(servo3_deg,-90,90,1100,2700);
  servo4_deg=SS_servo4[0]/3.14159265*180;
  servo4=map(servo4_deg,-90,38,2700,1500);
  servo5_deg=SS_servo5[0]/3.14159265*180;
  servo5=map(servo5_deg,-90,90,2600,930);
  servo6_deg=SS_servo6[0]/3.14159265*180;
  servo6=map(servo6_deg,-90,38,850,2250);
  servo7_deg=SS_servo7[0]/3.14159265*180;
  servo7=map(servo7_deg,-90,90,920,2620);
        
  pca9685.setPWM(SER0,0,servo0);
  pca9685.setPWM(SER1,0,servo1);
  pca9685.setPWM(SER2,0,servo2);
  pca9685.setPWM(SER3,0,servo3);
  pca9685.setPWM(SER4,0,servo4);
  pca9685.setPWM(SER5,0,servo5);
  pca9685.setPWM(SER6,0,servo6);
  pca9685.setPWM(SER7,0,servo7);

  Serial.print("Node:");
  Serial.println(node);
  Serial.print("servo0 -> rads:");
  Serial.print(SS_servo0[node]);
  Serial.print("        deg:");
  Serial.print(servo0_deg);
  Serial.print("        us:");
  Serial.println(servo0);
  Serial.print("servo1 -> rads:");
  Serial.print(SS_servo1[node]);
  Serial.print("        deg:");
  Serial.print(servo1_deg);
  Serial.print("        us:");
  Serial.println(servo1);
  Serial.print("servo2 -> rads:");
  Serial.print(SS_servo2[node]);
  Serial.print("        deg:");
  Serial.print(servo2_deg);
  Serial.print("        us:");
  Serial.println(servo2);
  Serial.print("servo3 -> rads:");
  Serial.print(SS_servo3[node]);
  Serial.print("        deg:");
  Serial.print(servo3_deg);
  Serial.print("        us:");
  Serial.println(servo3);
  Serial.print("servo4 -> rads:");
  Serial.print(SS_servo4[node]);
  Serial.print("        deg:");
  Serial.print(servo4_deg);
  Serial.print("        us:");
  Serial.println(servo4);
  Serial.print("servo5 -> rads:");
  Serial.print(SS_servo5[node]);
  Serial.print("        deg:");
  Serial.print(servo5_deg);
  Serial.print("        us:");
  Serial.println(servo5);
  Serial.print("servo6 -> rads:");
  Serial.print(SS_servo6[node]);
  Serial.print("        deg:");
  Serial.print(servo6_deg);
  Serial.print("        us:");
  Serial.println(servo6);
  Serial.print("servo7 -> rads:");
  Serial.print(SS_servo7[node]);
  Serial.print("        deg:");
  Serial.print(servo7_deg);
  Serial.print("        us:");
  Serial.println(servo7);

  Serial.println("10");
  delay(1000);
  Serial.println("9");
  delay(1000);
  Serial.println("8");
  delay(1000);
  Serial.println("7");
  delay(1000);
  Serial.println("6");
  delay(1000);
  Serial.println("5");
  delay(1000);
  Serial.println("4");
  delay(1000);
  Serial.println("3");
  delay(1000);
  Serial.println("2");
  delay(1000);
  Serial.println("1");
  delay(1000);

}

void loop() 
{
  if(Serial.available()>0)
  {
    first=Serial.read();
    if(first=='2')
    {
      input=2;
      node=0;
      one_print=1;
    }
    if(first=='1')
    {
      input=1;
      node=0;
      one_print=1;
    }
    if(first=='0')
    {
      input=0;
    }
  }
  if(input==1 or input==2)
  {
      if(esp_timer_get_time()>=end_time)
      {
        servo0_deg=SS_servo0[node]/3.14159265*180;
        servo0=map(servo0_deg,-38,90,2200,1030);
        servo1_deg=SS_servo1[node]/3.14159265*180;
        servo1=map(servo1_deg,-90,90,2600,950);
        servo2_deg=SS_servo2[node]/3.14159265*180;
        servo2=map(servo2_deg,-38,90,1510,2730);
        servo3_deg=SS_servo3[node]/3.14159265*180;
        servo3=map(servo3_deg,-90,90,1100,2700);
        servo4_deg=SS_servo4[node]/3.14159265*180;
        servo4=map(servo4_deg,-90,38,2700,1500);
        servo5_deg=SS_servo5[node]/3.14159265*180;
        servo5=map(servo5_deg,-90,90,2600,930);
        servo6_deg=SS_servo6[node]/3.14159265*180;
        servo6=map(servo6_deg,-90,38,850,2250);
        servo7_deg=SS_servo7[node]/3.14159265*180;
        servo7=map(servo7_deg,-90,90,920,2620);
        
        pca9685.setPWM(SER0,0,servo0);
        pca9685.setPWM(SER1,0,servo1);
        pca9685.setPWM(SER2,0,servo2);
        pca9685.setPWM(SER3,0,servo3);
        pca9685.setPWM(SER4,0,servo4);
        pca9685.setPWM(SER5,0,servo5);
        pca9685.setPWM(SER6,0,servo6);
        pca9685.setPWM(SER7,0,servo7);
        
        node+=1;
        if(node>=steps and input==1)
        {
          Serial.print("Input:");
          Serial.println(input);
          node=0;
        }
        if(node>=steps and input==2)
        {
          Serial.print("Input:");
          Serial.println(input);
          input=0;
        }
         end_time=esp_timer_get_time()+time_step;
      }
   }

  if(input == 0)
  {        
        pca9685.setPWM(SER0,0,servo0);
        pca9685.setPWM(SER1,0,servo1);
        pca9685.setPWM(SER2,0,servo2);
        pca9685.setPWM(SER3,0,servo3);
        pca9685.setPWM(SER4,0,servo4);
        pca9685.setPWM(SER5,0,servo5);
        pca9685.setPWM(SER6,0,servo6);
        pca9685.setPWM(SER7,0,servo7);

        if(one_print==1)
        {
          Serial.print("Input:");
          Serial.println(input);
          Serial.print("Node:");
          Serial.println(node);
          Serial.print("servo0 -> rads:");
          Serial.print(SS_servo0[node]);
          Serial.print("        deg:");
          Serial.print(servo0_deg);
          Serial.print("        us:");
          Serial.println(servo0);
          Serial.print("servo1 -> rads:");
          Serial.print(SS_servo1[node]);
          Serial.print("        deg:");
          Serial.print(servo1_deg);
          Serial.print("        us:");
          Serial.println(servo1);
          Serial.print("servo2 -> rads:");
          Serial.print(SS_servo2[node]);
          Serial.print("        deg:");
          Serial.print(servo2_deg);
          Serial.print("        us:");
          Serial.println(servo2);
          Serial.print("servo3 -> rads:");
          Serial.print(SS_servo3[node]);
          Serial.print("        deg:");
          Serial.print(servo3_deg);
          Serial.print("        us:");
          Serial.println(servo3);
          Serial.print("servo4 -> rads:");
          Serial.print(SS_servo4[node]);
          Serial.print("        deg:");
          Serial.print(servo4_deg);
          Serial.print("        us:");
          Serial.println(servo4);
          Serial.print("servo5 -> rads:");
          Serial.print(SS_servo5[node]);
          Serial.print("        deg:");
          Serial.print(servo5_deg);
          Serial.print("        us:");
          Serial.println(servo5);
          Serial.print("servo6 -> rads:");
          Serial.print(SS_servo6[node]);
          Serial.print("        deg:");
          Serial.print(servo6_deg);
          Serial.print("        us:");
          Serial.println(servo6);
          Serial.print("servo7 -> rads:");
          Serial.print(SS_servo7[node]);
          Serial.print("        deg:");
          Serial.print(servo7_deg);
          Serial.print("        us:");
          Serial.println(servo7);
          one_print=0;
        }
  
  }
}
